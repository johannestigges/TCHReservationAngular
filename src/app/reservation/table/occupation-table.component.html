<router-outlet></router-outlet>
<div class="row">
  <h2 class="col-md-8">Reservierungen {{showDate()}}</h2>
  <div class="col-md-4">
    <button (click)='onBackWeek()' title="Eine Woche zurück" class="btn btn-space"><<</button>
    <button (click)='onBackDay()' title="Einen Tag zurück" class="btn btn-space"><</button>
    <button (click)='onToday()' title="Heute" class="btn btn-primary btn-space">+</button>
    <button (click)='onNextDay()' title="Einen Tag vor" class="btn btn-space">></button>
    <button (click)='onNextWeek()' title="Eine Woche vor" class="btn btn-space">>></button>

    <div class="text-right">
      <div *ngIf="!isLoggedIn()">
        <a href='../../login'>login</a>
      </div>
      <div *ngIf="isLoggedIn()">
        {{occupationTable.user.name}}
      </div>
    </div>
  </div>

<table class="occupation_table">
	<thead>
		<tr>
			<th>Uhrzeit</th>
			<th *ngFor="let court of systemConfig.getCourtsArray()">Platz {{court}}</th>
		</tr>
	</thead>
	<tbody>
		<tr *ngFor="let row of occupationTable.table">
			<ng-container *ngFor="let cell of row">
        <ng-container *ngIf="cell.rowspan > 0 && cell.colspan > 0">
          <ng-container *ngIf="cell.data; else noCellData">
				    <!-- first column with time data -->
            <td *ngIf="cell.data.time"
              [attr.rowspan]="cell.rowspan" [attr.colspan]="cell.colspan">
					    {{cell.data.time}}
            </td>

				    <!-- occupation entry with link to modify or delete occupation -->
				    <td *ngIf="cell.data.text && canModify(cell.data)"
              [attr.rowspan]="cell.rowspan" [attr.colspan]="cell.colspan"
              class="type{{cell.data.type}} deletable">
					    <a routerLink='/modify/{{systemConfig.id}}/{{cell.data.reservation.id}}'>
						    {{cell.data.text}}
					    </a>
				    </td>

				    <!-- occupation entry -->
				    <td *ngIf="cell.data.text && !canModify(cell.data)"
              [attr.rowspan]="cell.rowspan" [attr.colspan]="cell.colspan"
              class="type{{cell.data.type}}">
					    {{cell.data.text}}
            </td>

				    <!-- available cell with link to add reservation -->
				    <td *ngIf="cell.data.css && canAdd(cell.data.date)"
              [attr.rowspan]="cell.rowspan" [attr.colspan]="cell.colspan"
              class="{{cell.data.css}}_reservable">
					    <a routerLink='/add/{{systemConfig.id}}/{{cell.data.court}}/{{cell.data.date}}'>
                &nbsp;
              </a>
				    </td>

				    <!-- available cell without link to add reservation -->
				    <td *ngIf="cell.data.css && !canAdd(cell.data.date)"
              [attr.rowspan]="cell.rowspan" [attr.colspan]="cell.colspan"
              class="{{cell.data.css}}"
              style="height:100%;width:100%">
            </td>
          </ng-container>

          <ng-template #noCellData>
            <!-- no data? available cell without link -->
				    <td [attr.rowspan]="cell.rowspan" [attr.colspan]="cell.colspan"
              class="available">
            </td>
          </ng-template>
        </ng-container>
			</ng-container>
		</tr>
	</tbody>
</table>
<div>{{error}}</div>
